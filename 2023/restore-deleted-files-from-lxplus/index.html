<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Restore deleted files from lxplus | My Blog </title> <meta name="description" content=" A collection of notes about physics, programming and personal thoughts. "> <meta name="keywords" content="Linux, Server, CERN, lxplus"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="MohamedElashri"> <meta name="twitter:title" content=" Restore deleted files from lxplus | My Blog "> <meta name="twitter:description" content=" A collection of notes about physics, programming and personal thoughts. "> <meta name="twitter:image:src" content="https://blog.melashri.net"> <!-- Canonical link tag --> <link rel="canonical" href="https://blog.melashri.net/2023/restore-deleted-files-from-lxplus/"> <link rel="alternate" type="application/rss+xml" title="My Blog" href="https://blog.melashri.net/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="https://blog.melashri.net/assets/css/main.css"> <link rel="stylesheet" href="/assets/css/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="https://blog.melashri.net/">My Blog<span></span></a> </h1> <ul class="navbar"> <li><a href="https://blog.melashri.net/about">About</a></li> <li><a href="https://blog.melashri.net/feed.xml" target="_blank">RSS</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2023-01-04T00:00:00+00:00" itemprop="datePublished">Jan 4, 2023</time></p> <h1 class="post-title" itemprop="name headline">Restore deleted files from lxplus</h1> </header> <div class="post-content" itemprop="articleBody"> <p>Earlier today I was trying to connect my VScode to lxplus and I was unable. I was trying to connect to particular working folder but it seems that vscode can’t find this folder. This was strange so I opened my terminal and then sshed to lxplus. I was surprised to find that this folder on my work directory is not there. This was annoying as it contains some MC files I generated locally which took somedays (as I still early in my analysis and don’t have a GRID ready analysis). The idea of having of having to generate all of them again was not good by any mean. I don’t have time for that. Beside in the process of generating them I was very annoying for CERN as I got many warning emails from CERN about my high memory usage (yes Gauss is a RAM monester). The source code for Gauss-job and analysis scripts weren’t a problem as I always have them pushed to a git repository on my github account. So I was able to recover them from there. But the MC files were a problem.</p> <p>Now I was hoping there was a way to restore the deleted files. I went to Twiki and looked for a solution and found an article that describes the process. I was happy for know that all <code class="highlighter-rouge">afs</code> is being backuped regularly. Also they backup personal <code class="highlighter-rouge">home</code> and <code class="highlighter-rouge">work</code> spaces for each user. There is a difference however between both of them as the files stored in <code class="highlighter-rouge">home</code> and deleted are cached and you don’t need to get them from <code class="highlighter-rouge">tape</code>. Anyway it was good to know that <code class="highlighter-rouge">home</code> directory is backed each night (CERN time) and cached inside <code class="highlighter-rouge">/afs/cern.ch/ubackup/m/melashri/*</code> where I could easily find the deleted files (up to 24 hours) beside other files. But actually my MC files were on <code class="highlighter-rouge">work</code> directory which is not cached. The backup are actually on tape which is slow to restore and process it a little bit more involved than just move the files back.</p> <p>To store the files, the first was to create an empty folder with the following</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>afs_admin recover /afs/cern.ch/work/m/melashri/&lt;path_to_my_missing_files&gt;
</code></pre></div></div> <p>The output asked me what backup I would like to recover. I chosed the latest one and then it will take sometime (long time) to restore the files. The backup will be written to a temporary folder and then you need to move the files to the correct location. The output will give you the path to the temporary folder. I then moved the files to the correct location.</p> <p>This was my first day after the new year holiday and I was feeling horrible that I had this issue. I don’t recall what happened last week that could lead to this but anyway I was happy that everything worked out and now I can continue struggling with my analysis.</p> </div> </article> <aside id="comments" class="isso"> <div class="container"> <h3><i class="icon icon-comments-o"></i> Comments</h3> <div id="isso_thread"></div> <script data-isso="https://comments.melashri.eu.org/" data-isso-avatar="true" data-isso-vote="true" data-isso-vote-levels="-5,5" src="https://comments.melashri.eu.org/js/embed.min.js"></script> <section id="isso-thread"></section> <noscript> Please enable JavaScript to view the <a href="https://blog.melashri.net" rel="nofollow">comments powered by ISSO.</a> </noscript> </div> </aside> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2023 Mohamed Elashri &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> and <a href="https://github.com/VerifiedGruber/thinkspace">Thinkspace theme</a></small> </div> </footer> </main> </body> </html>
