<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Write Hello World in OpenMP and C | My Blog </title> <meta name="description" content=" How to write Hello World in OpenMP and C. "> <meta name="keywords" content="OPENMP, C, Hello World, tutorial"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="MohamedElashri"> <meta name="twitter:title" content=" Write Hello World in OpenMP and C | My Blog "> <meta name="twitter:description" content=" How to write Hello World in OpenMP and C. "> <meta name="twitter:image:src" content="https://blog.melashri.net"> <!-- Canonical link tag --> <link rel="canonical" href="https://blog.melashri.net/2022/openmp-hello-world/"> <link rel="alternate" type="application/rss+xml" title="My Blog" href="https://blog.melashri.net/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="https://blog.melashri.net/assets/css/main.css"> <link rel="stylesheet" href="/assets/css/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="https://blog.melashri.net/">My Blog<span></span></a> </h1> <ul class="navbar"> <li><a href="https://blog.melashri.net/about">About</a></li> <li><a href="https://blog.melashri.net/feed.xml" target="_blank">RSS</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2022-09-15T00:00:00+00:00" itemprop="datePublished">Sep 15, 2022</time></p> <h1 class="post-title" itemprop="name headline">Write Hello World in OpenMP and C</h1> </header> <div class="post-content" itemprop="articleBody"> <hr /> <p>Early this month i attened CoDaS hep summer school. It is meant for phycics graduate students to learn more about data analysis and machine learning in the field of high energy physics. During the school, we learned a lot of things about data analysis and machine learning. One of the topics we learned was how to use OpenMP to parallelize our code. In this post, I will show you how to write a simple Hello World program in OpenMP and C.</p> <ul> <li>What is OpenMP?</li> </ul> <p>OpenMP is a standard for parallel programming in C, C++, and Fortran. It provides a set of directives, functions, and data environment that allows programmers to write parallel code that can be executed on multiple CPU cores.</p> <p>OpenMP allows programmers to specify which parts of the code should be executed in parallel and which parts should be executed sequentially. This enables them to write efficient parallel programs that can take advantage of the multiple CPU cores in a system.</p> <p>OpenMP also provides a set of tools and libraries that can be used to manage the execution of parallel code, such as scheduling the threads and controlling their synchronization. These tools and libraries can be used to improve the performance of parallel programs and make them more efficient.</p> <p>OpenMP is widely used in many fields, including scientific computing, data analysis, and technical computing. It is supported by many compilers and platforms, and it is compatible with a wide range of programming languages.</p> <ul> <li>Why use C not C++?</li> </ul> <p>Basically because it is what I have been introduced and C is a popular programming language that is widely used in many fields, including software development, scientific computing, and systems programming.</p> <p>In this post, I will show you how to write a simple “Hello, World!” example in C and OpenMP. This example will demonstrate how to use the OpenMP library to parallelize a C program and execute it on multiple CPU cores.</p> <p>To write a “Hello, World!” example in C and OpenMP, you first need to include the OpenMP header file in your program. This header file provides the declarations and definitions of the OpenMP functions and macros that you can use in your code.</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;omp.h&gt;</span><span class="cp">
</span></code></pre></div></div> <p>Next, you need to define the <code class="highlighter-rouge">main()</code> function, which is the entry point of the program. In this function, you can use the <code class="highlighter-rouge">#pragma omp</code> parallel directive to specify that the code within the directive should be executed in parallel by multiple threads.</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="cp">#pragma omp parallel
</span>  <span class="p">{</span>
    <span class="c1">// Code to be executed in parallel by multiple threads</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p>Within the <code class="highlighter-rouge">#pragma</code> omp parallel directive, you can use the <code class="highlighter-rouge">printf()</code> function to print the <code class="highlighter-rouge">"Hello, World!"</code> message. Now a more complete version of the “Hello, World!” example in C and OpenMP looks like this:</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;omp.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="kt">int</span> <span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">tid</span><span class="p">;</span>
    <span class="cp">#pragma omp parallel private(nthreads, tid)
</span>    <span class="p">{</span>
        <span class="n">tid</span> <span class="o">=</span> <span class="n">omp_get_thread_num</span><span class="p">();</span>
        <span class="n">nthreads</span> <span class="o">=</span> <span class="n">omp_get_num_threads</span><span class="p">();</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Hello World Thread %d / %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">tid</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p>This code is a simple “Hello, World!” example in C that uses the OpenMP library to parallelize the execution of the program. It includes the OpenMP header file <code class="highlighter-rouge">&lt;omp.h&gt;</code> and the standard input/output header file <code class="highlighter-rouge">&lt;stdio.h&gt;</code> to access the OpenMP functions and the <code class="highlighter-rouge">printf()</code> function, respectively.</p> <p>In the <code class="highlighter-rouge">main()</code> function, the <code class="highlighter-rouge">#pragma omp</code> parallel directive as explained before is used to specify that the code within the directive should be executed in parallel by multiple threads. The <code class="highlighter-rouge">private()</code> clause is used to specify that the nthreads and tid variables should be private to each thread and not shared among them.</p> <p>Within the <code class="highlighter-rouge">#pragma omp</code> parallel directive, the <code class="highlighter-rouge">omp_get_thread_num()</code> function is used to get the thread ID of the current thread, and the <code class="highlighter-rouge">omp_get_num_threads()</code> function is used to get the total number of threads. These values are then printed using the printf() function.</p> <p>When this code is executed, the “Hello, World!” message will be printed multiple times, once for each thread that is executing the code within the <code class="highlighter-rouge">#pragma omp</code> parallel directive. The thread ID and the total number of threads will be printed with each message, so you can see how the code is being executed in parallel by multiple threads.</p> <ul> <li>How to compile and run the code?</li> </ul> <ol> <li>Install GCC with OpenMP as default gcc in Mac is CLANG and doesn’t have OMP.</li> <li>Install gcc via home brew. <code class="highlighter-rouge">brew install gcc</code></li> <li>Maybe in your shell you can use <code class="highlighter-rouge">alias gcc=gcc-11</code> to make it easy (and follow online tutorials make)</li> <li>To compile run <code class="highlighter-rouge">gcc -fopenmp omp.c -o omp</code></li> <li>Run the example by <code class="highlighter-rouge">./omp</code></li> </ol> </div> </article> <aside id="comments" class="isso"> <div class="container"> <h3><i class="icon icon-comments-o"></i> Comments</h3> <div id="isso_thread"></div> <script data-isso="https://comments.melashri.eu.org/" data-isso-avatar="true" data-isso-vote="true" data-isso-vote-levels="-5,5" src="https://comments.melashri.eu.org/js/embed.min.js"></script> <section id="isso-thread"></section> <noscript> Please enable JavaScript to view the <a href="https://blog.melashri.net" rel="nofollow">comments powered by ISSO.</a> </noscript> </div> </aside> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2023 Mohamed Elashri &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> and <a href="https://github.com/VerifiedGruber/thinkspace">Thinkspace theme</a></small> </div> </footer> </main> </body> </html>
