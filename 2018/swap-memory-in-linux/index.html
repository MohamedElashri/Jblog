<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Swap Memory in Linux | My Blog </title> <meta name="description" content=" How to create and use swap memory in Linux "> <meta name="keywords" content="linux, swap, memory, ubuntu, debian"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="MohamedElashri"> <meta name="twitter:title" content=" Swap Memory in Linux | My Blog "> <meta name="twitter:description" content=" How to create and use swap memory in Linux "> <meta name="twitter:image:src" content="https://blog.melashri.net"> <!-- Canonical link tag --> <link rel="canonical" href="https://blog.melashri.net/2018/swap-memory-in-linux/"> <link rel="alternate" type="application/rss+xml" title="My Blog" href="https://blog.melashri.net/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="https://blog.melashri.net/assets/css/main.css"> <link rel="stylesheet" href="/assets/css/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="https://blog.melashri.net/">My Blog<span></span></a> </h1> <ul class="navbar"> <li><a href="https://blog.melashri.net/about">About</a></li> <li><a href="https://blog.melashri.net/feed.xml" target="_blank">RSS</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2018-12-17T00:00:00+00:00" itemprop="datePublished">Dec 17, 2018</time></p> <h1 class="post-title" itemprop="name headline">Swap Memory in Linux</h1> </header> <div class="post-content" itemprop="articleBody"> <hr /> <p>In Linux, swap memory is a type of virtual memory that is used when the systemâ€™s physical memory (RAM) is full. It allows the system to temporarily store data in the swap space on the hard drive when the RAM is full, which can help improve system performance.</p> <p>To create swap memory in Linux, you can use the <code class="highlighter-rouge">fallocate</code> command to create a file that will be used as swap space. For example, to create a 1 GB swap file, you can use the following command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>fallocate <span class="nt">-l</span> 1G /swapfile
</code></pre></div></div> <p>This command creates a file named <code class="highlighter-rouge">/swapfile</code> with a size of 1 GB (1024 MB) in the root directory.</p> <p>Next, you need to set the appropriate permissions on the swap file. This can be done using the chmod and chown commands. For example, to set the permissions to 600 (read and write access only for the owner), you can use the following command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo chmod </span>600 /swapfile
</code></pre></div></div> <p>To set the owner of the swap file to the root user, you can use the following command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo chown </span>root:root /swapfile
</code></pre></div></div> <p>After setting the permissions on the swap file, you can use the <code class="highlighter-rouge">mkswap</code> command to initialize it as swap space. For example, you can use the following command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mkswap /swapfile
</code></pre></div></div> <p>Finally, you can enable the swap file by using the <code class="highlighter-rouge">swapon</code> command. For example, you can use the following command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>swapon /swapfile
</code></pre></div></div> <p>After enabling the swap file, it will be used by the system whenever the RAM is full. You can check the status of the swap space using the free command. For example, the following command shows the total, used, and free swap space:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>free <span class="nt">-h</span>
</code></pre></div></div> <p>Once you have created a swap file and enabled it in Linux, you can tune the kernel to use it more efficiently. This can help improve system performance by allowing the kernel to make better use of the available swap space.</p> <p>To tune the kernel to use the swap memory, you can modify the <code class="highlighter-rouge">vm.swappiness</code> and <code class="highlighter-rouge">vm.vfs_cache_pressure</code> sysctl parameters. These parameters control how the kernel uses the swap space and the page cache, respectively.</p> <p>The <code class="highlighter-rouge">vm.swappiness</code> parameter determines how aggressively the kernel will use the swap space. A value of 0 means that the kernel will only use the swap space when the physical memory is completely full, while a value of 100 means that the kernel will use the swap space even when there is free physical memory available.</p> <p>The <code class="highlighter-rouge">vm.vfs_cache_pressure</code> parameter determines how aggressively the kernel will shrink the page cache. A value of 0 means that the kernel will never shrink the page cache, while a value of 100 means that the kernel will aggressively shrink the page cache.</p> <p>To modify these <code class="highlighter-rouge">sysctl</code> parameters, you can use the sysctl command. For example, to set the <code class="highlighter-rouge">vm.swappiness</code> parameter to 10 and the <code class="highlighter-rouge">vm.vfs_cache_pressure</code> parameter to 50, you can use the following commands:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>sysctl vm.swappiness<span class="o">=</span>10
<span class="nb">sudo </span>sysctl vm.vfs_cache_pressure<span class="o">=</span>50
</code></pre></div></div> <p>These commands set the <code class="highlighter-rouge">vm.swappiness</code> and <code class="highlighter-rouge">vm.vfs_cache_pressure </code>parameters to the specified values. You can use the <code class="highlighter-rouge">sysctl</code> command to view the current values of these parameters as well.</p> <p>Note that the sysctl parameters are reset to their default values when the system is restarted. To make the changes permanent, you can add the sysctl commands to the <code class="highlighter-rouge">/etc/sysctl.conf </code>file. This file is read by the kernel when the system is booted, and the specified <code class="highlighter-rouge">sysctl</code> parameters will be set automatically.</p> <p>To add the sysctl commands to the <code class="highlighter-rouge">/etc/sysctl.conf</code> file, you can use the following commands:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"vm.swappiness=10"</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/sysctl.conf
<span class="nb">echo</span> <span class="s2">"vm.vfs_cache_pressure=50"</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/sysctl.conf
</code></pre></div></div> <h3 id="update">update</h3> <p>Recently I have created a <a href="https://gist.github.com/MohamedElashri/559c35548e5985ad6e96c461156eec07">bash script</a> that automates the process of creating and enabling swap memory in Linux. It is mainly intended for use on on low memory machines.</p> </div> </article> <aside id="comments" class="isso"> <div class="container"> <h3><i class="icon icon-comments-o"></i> Comments</h3> <div id="isso_thread"></div> <script data-isso="https://comments.melashri.eu.org/" data-isso-avatar="true" data-isso-vote="true" data-isso-vote-levels="-5,5" src="https://comments.melashri.eu.org/js/embed.min.js"></script> <section id="isso-thread"></section> <noscript> Please enable JavaScript to view the <a href="https://blog.melashri.net" rel="nofollow">comments powered by ISSO.</a> </noscript> </div> </aside> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2023 Mohamed Elashri &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> and <a href="https://github.com/VerifiedGruber/thinkspace">Thinkspace theme</a></small> </div> </footer> </main> </body> </html>
